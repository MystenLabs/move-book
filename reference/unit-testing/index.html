<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-reference docs-version-current docs-doc-page docs-doc-id-unit-testing" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Unit Tests | Reference | The Move Book</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://move-book.com/reference/unit-testing"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="algolia-site-verification" content="BCA21DA2879818D2"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-reference-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-reference-current"><meta data-rh="true" property="og:title" content="Unit Tests | Reference | The Move Book"><link data-rh="true" rel="icon" href="/favicon.svg"><link data-rh="true" rel="canonical" href="https://move-book.com/reference/unit-testing"><link data-rh="true" rel="alternate" href="https://move-book.com/reference/unit-testing" hreflang="en"><link data-rh="true" rel="alternate" href="https://move-book.com/reference/unit-testing" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1E7R0BHX4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B1E7R0BHX4",{anonymize_ip:!0})</script>



<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Rubik:wght@300&amp;amp;display=swap">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/styles.f79f3242.css">
<script src="/assets/js/runtime~main.3a6e37dd.js" defer="defer"></script>
<script src="/assets/js/main.9757aefb.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_OH5z" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a><a class="navbar__item navbar__link" href="/">Move Book</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/reference">Move Reference</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_aspp"><div class="navbar__search searchBarContainer_reza" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_Kpxf" value=""><div class="loadingRing_LRD_ searchBarLoadingRing_lY7z"><div></div><div></div><div></div><div></div></div></div></div><a href="https://github.com/MystenLabs/move-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><i class="fab fa-github"></i></a><div class="toggle_MW0i colorModeToggle_RHuM"><button class="clean-btn toggleButton_yw5v toggleButtonDisabled_BJd7" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><i aria-hidden="true" class="toggleIcon_oIOL lightToggleIcon_SFTY fas fa-moon"></i><i aria-hidden="true" class="toggleIcon_oIOL darkToggleIcon_ekgs fas fa-sun"></i><i aria-hidden="true" class="toggleIcon_oIOL systemToggleIcon_yi_a fas fa-moon"></i></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_wWoK"><div class="docsWrapper_nrtX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_xs6u" type="button"></button><div class="docRoot_XRUv"><aside class="theme-doc-sidebar-container docSidebarContainer_vhZZ"><div class="sidebarViewport_HXJ_"><div class="sidebar_B2tA"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_RelJ"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/reference/">The Move Reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Getting Started</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/modules">1. Modules</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Basic Concepts</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/primitive-types">2. Primitive Types</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/integers">2.1 Integers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/bool">2.2 Bool</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/address">2.3 Address</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/vector">2.4 Vector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/references">2.5 References</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/tuples">2.6 Tuples and Unit</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/variables">3. Local Variables and Scopes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/equality">4. Equality</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/abort-and-assert">5. Abort and Assert</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/abort-and-assert/clever-errors">5.1 Clever Errors</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/control-flow">6. Control Flow</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/conditionals">6.1 Conditional Expressions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/loops">6.2 Loops</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/labeled-control-flow">6.3 Labeled Control Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/pattern-matching">6.4 Pattern Matching</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/functions">7. Functions</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/functions/macros">7.1 Macros</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/structs">8. Structs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/enums">9. Enums</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/constants">10. Constants</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/generics">11. Generics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/abilities">12. Abilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/uses">13. Uses and Aliases</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Advanced Concepts</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/method-syntax">14. Method Syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/index-syntax">15. Index Syntax</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Tooling</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/packages">16. Packages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reference/unit-testing">17. Unit Testing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Reference</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/coding-conventions">18. Coding Conventions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Deprecated</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/friends">19. Friends</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_oT2n"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_LCKf"><div class="docItemContainer_Jixr"><article><div class="tocCollapsible_vYTS theme-doc-toc-mobile tocMobile_QhsY"><button type="button" class="clean-btn tocCollapsibleButton_nB9w">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Unit Tests</h1></header>
<p>Unit testing for Move uses three annotations in the Move source language:</p>
<ul>
<li><span class="inline-code">#[test]</span> marks a function as a test;</li>
<li><span class="inline-code">#[expected_failure]</span> marks that a test is expected to fail;</li>
<li><span class="inline-code">#[test_only]</span> marks a module or module member (<a href="/reference/uses"><span class="inline-code">use</span></a>, <a href="/reference/functions">function</a>,
<a href="/reference/structs">struct</a>, or <a href="/reference/constants">constant</a>) as code to be included for testing only.</li>
</ul>
<p>These annotations can be placed on any appropriate form with any visibility. Whenever a module or
module member is annotated as <span class="inline-code">#[test_only]</span> or <span class="inline-code">#[test]</span>, it will not be included in the compiled
bytecode unless it is compiled for testing.</p>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="test-annotations">Test Annotations<a href="#test-annotations" class="hash-link" aria-label="Direct link to Test Annotations" title="Direct link to Test Annotations">​</a></h2>
<p>The <span class="inline-code">#[test]</span> annotation can only be placed on a function with no parameters. This annotation marks
the function as a test to be run by the unit testing harness.</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test]</span><span class="token plain"> </span><span class="token comment" style="color:#A0A1A7">// OK</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">this_is_a_test</span><span class="token plain">() { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test]</span><span class="token plain"> </span><span class="token comment" style="color:#A0A1A7">// Will fail to compile since the test takes an argument</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">this_is_not_correct</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">arg</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">) { ... }</span><br></span></code></pre></div></div>
<p>A test can also be annotated as an <span class="inline-code">#[expected_failure]</span>. This annotation marks that the test is
expected to raise an error. There are a number of options that can be used with the
<span class="inline-code">#[expected_failure]</span> annotation to ensure only a failure with the specified condition is marked as
passing, these options are detailed in <a href="#expected-failures">Expected Failures</a>. Only functions that
have the <span class="inline-code">#[test]</span> annotation can also be annotated as an #<span class="inline-code">[expected_failure]</span>.</p>
<p>Some simple examples of using the <span class="inline-code">#[expected_failure]</span> annotation are shown below:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">this_test_will_abort_and_pass</span><span class="token plain">() { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_error_and_pass</span><span class="token plain">() { </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">; }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:#A0A1A7">// Will pass since test fails with the expected abort code constant.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:#A0A1A7">// ENotFound is a constant defined in the module.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(abort_code = ENotFound)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_error_and_pass_abort_code</span><span class="token plain">() { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token error-const" style="color:#E45649">ENotFound</span><span class="token plain"> }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:#A0A1A7">// Will fail since test fails with a different error than expected.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(abort_code = my_module::ENotFound)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_error_and_fail</span><span class="token plain">() { </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">; }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure]</span><span class="token plain"> </span><span class="token comment" style="color:#A0A1A7">// Can have multiple in one attribute. This test will pass.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">this_other_test_will_abort_and_pass</span><span class="token plain">() { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> }</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>Note</strong>: <span class="inline-code">#[test]</span> and <span class="inline-code">#[test_only]</span> functions can also call
<a href="/reference/functions#entry-modifier"><span class="inline-code">entry</span></a> functions, regardless of their visibility.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="expected-failures">Expected Failures<a href="#expected-failures" class="hash-link" aria-label="Direct link to Expected Failures" title="Direct link to Expected Failures">​</a></h2>
<p>There are a number of different ways that you can use the <span class="inline-code">#[expected_failure]</span> annotation to
specify different types of error conditions. These are:</p>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="1-expected_failureabort_code--constant">1. <span class="inline-code">#[expected_failure(abort_code = &lt;constant&gt;)]</span><a href="#1-expected_failureabort_code--constant" class="hash-link" aria-label="Direct link to 1-expected_failureabort_code--constant" title="Direct link to 1-expected_failureabort_code--constant">​</a></h3>
<p>This will pass if the test aborts with the specified constant value in the module that defines the
constant and fail otherwise. This is the recommended way of testing for expected test failures.</p>
<blockquote>
<p><strong>Note</strong>: You can reference constants outside of the current module or package in
<span class="inline-code">expected_failure</span> annotations.</p>
</blockquote>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">pkg_addr</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">other_module</span><span class="token module-header"> {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token const const-keyword keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token const"> </span><span class="token const error-const-name error-const" style="color:#E45649">ENotFound</span><span class="token const">: </span><span class="token const const-type support" style="color:#0184BC">u64</span><span class="token const"> = </span><span class="token const const-name constant" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">will_abort</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token error-const" style="color:#E45649">ENotFound</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">pkg_addr</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">my_module</span><span class="token module-header"> {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token use-import-fun use-keyword keyword" style="color:hsl(301, 63%, 40%)">use</span><span class="token use-import-fun"> pkg_addr</span><span class="token use-import-fun double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token use-import-fun">other_module;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token const const-keyword keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token const"> </span><span class="token const error-const-name error-const" style="color:#E45649">ENotFound</span><span class="token const">: </span><span class="token const const-type support" style="color:#0184BC">u64</span><span class="token const"> = </span><span class="token const const-name constant" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(abort_code = ENotFound)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_abort_and_pass</span><span class="token plain">() { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token error-const" style="color:#E45649">ENotFound</span><span class="token plain"> }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(abort_code = other_module::ENotFound)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_abort_and_pass</span><span class="token plain">() { other_module::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">will_abort</span><span class="token plain">() }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// FAIL: Will not pass since we are expecting the constant from the wrong module.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(abort_code = ENotFound)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_abort_and_pass</span><span class="token plain">() { other_module::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">will_abort</span><span class="token plain">() }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="2-expected_failurearithmetic_error-location--location">2. <span class="inline-code">#[expected_failure(arithmetic_error, location = &lt;location&gt;)]</span><a href="#2-expected_failurearithmetic_error-location--location" class="hash-link" aria-label="Direct link to 2-expected_failurearithmetic_error-location--location" title="Direct link to 2-expected_failurearithmetic_error-location--location">​</a></h3>
<p>This specifies that the test is expected to fail with an arithmetic error (e.g., integer overflow,
division by zero, etc) at the specified location. The <span class="inline-code">&lt;location&gt;</span> must be a valid path to a module
location, e.g., <span class="inline-code">Self</span>, or <span class="inline-code">my_package::my_module</span>.</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">pkg_addr</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">other_module</span><span class="token module-header"> {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">will_arith_error</span><span class="token plain">() { </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">; }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">pkg_addr</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">my_module</span><span class="token module-header"> {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token use-import-fun use-keyword keyword" style="color:hsl(301, 63%, 40%)">use</span><span class="token use-import-fun"> pkg_addr</span><span class="token use-import-fun double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token use-import-fun">other_module;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(arithmetic_error, location = Self)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_arith_error_and_pass1</span><span class="token plain">() { </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">; }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(arithmetic_error, location = pkg_addr::other_module)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_arith_error_and_pass2</span><span class="token plain">() { other_module::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">will_arith_error</span><span class="token plain">() }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// FAIL: Will fail since the location we expect it the fail at is different from where</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// the test actually failed.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(arithmetic_error, location = Self)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_arith_error_and_fail</span><span class="token plain">() { other_module::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">will_arith_error</span><span class="token plain">() }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="3-expected_failureout_of_gas-location--location">3. <span class="inline-code">#[expected_failure(out_of_gas, location = &lt;location&gt;)]</span><a href="#3-expected_failureout_of_gas-location--location" class="hash-link" aria-label="Direct link to 3-expected_failureout_of_gas-location--location" title="Direct link to 3-expected_failureout_of_gas-location--location">​</a></h3>
<p>This specifies that the test is expected to fail with an out of gas error at the specified location.
The <span class="inline-code">&lt;location&gt;</span> must be a valid path to a module location, e.g., <span class="inline-code">Self</span>, or
<span class="inline-code">my_package::my_module</span>.</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">pkg_addr</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">other_module</span><span class="token module-header"> {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">will_oog</span><span class="token plain">() { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">loop</span><span class="token plain"> {} }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">pkg_addr</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">my_module</span><span class="token module-header"> {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token use-import-fun use-keyword keyword" style="color:hsl(301, 63%, 40%)">use</span><span class="token use-import-fun"> pkg_addr</span><span class="token use-import-fun double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token use-import-fun">other_module;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(out_of_gas, location = Self)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_oog_and_pass1</span><span class="token plain">() { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">loop</span><span class="token plain"> {} }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(arithmetic_error, location = pkg_addr::other_module)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_oog_and_pass2</span><span class="token plain">() { other_module::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">will_oog</span><span class="token plain">() }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// FAIL: Will fail since the location we expect it the fail at is different from where</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// the test actually failed.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(out_of_gas, location = Self)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_oog_and_fail</span><span class="token plain">() { other_module::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">will_oog</span><span class="token plain">() }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="4-expected_failurevector_error-minor_status--u64_opt-location--location">4. <span class="inline-code">#[expected_failure(vector_error, minor_status = &lt;u64_opt&gt;, location = &lt;location&gt;)]</span><a href="#4-expected_failurevector_error-minor_status--u64_opt-location--location" class="hash-link" aria-label="Direct link to 4-expected_failurevector_error-minor_status--u64_opt-location--location" title="Direct link to 4-expected_failurevector_error-minor_status--u64_opt-location--location">​</a></h3>
<p>This specifies that the test is expected to fail with a vector error at the specified location with
the given <span class="inline-code">minor_status</span> (if provided). The <span class="inline-code">&lt;location&gt;</span> must be a valid path to a module module
location, e.g., <span class="inline-code">Self</span>, or <span class="inline-code">my_package::my_module</span>. The <span class="inline-code">&lt;u64_opt&gt;</span> is an optional parameter that
specifies the minor status of the vector error. If it is not specified, the test will pass if the
test fails with any minor status. If it is specified, the test will only pass if the test fails with
a vector error with the specified minor status.</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">pkg_addr</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">other_module</span><span class="token module-header"> {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">vector_borrow_empty</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        &amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;[][</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">pkg_addr</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">my_module</span><span class="token module-header"> {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(vector_error, location = Self)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">vector_abort_same_module</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">(&amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;[], </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(vector_error, location = pkg_addr::other_module)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">vector_abort_same_module</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        other_module::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector_borrow_empty</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// Can specify minor statues (i.e., vector-specific error codes) to expect.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(vector_error, minor_status = 1, location = Self)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">native_abort_good_right_code</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">(&amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;[], </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// FAIL: correct error, but wrong location.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(vector_error, location = pkg_addr::other_module)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">vector_abort_same_module</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        other_module::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector_borrow_empty</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// FAIL: correct error and location but the minor status differs so this test will fail.</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(vector_error, minor_status = 0, location = Self)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">vector_abort_wrong_minor_code</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">(&amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;[], </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="5-expected_failure">5. <span class="inline-code">#[expected_failure]</span><a href="#5-expected_failure" class="hash-link" aria-label="Direct link to 5-expected_failure" title="Direct link to 5-expected_failure">​</a></h3>
<p>This will pass if the test aborts with <em>any</em> error code. You should be <strong><em>incredibly careful</em></strong>
using this to annotate expected tests failures, and always prefer one of the ways described above
instead. Examples of these types of annotations are:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_abort_and_pass1</span><span class="token plain">() { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_will_arith_error_and_pass2</span><span class="token plain">() { </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">/</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">; }</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="test-only-annotations">Test Only Annotations<a href="#test-only-annotations" class="hash-link" aria-label="Direct link to Test Only Annotations" title="Direct link to Test Only Annotations">​</a></h2>
<p>A module and any of its members can be declared as test only. If an item is annotated as
<span class="inline-code">#[test_only]</span> the item will only be included in the compiled Move bytecode when compiled in test
mode. Additionally, when compiled outside of test mode, any non-test <span class="inline-code">use</span>s of a <span class="inline-code">#[test_only]</span>
module will raise an error during compilation.</p>
<blockquote>
<p><strong>Note</strong>: functions that are annotated with <span class="inline-code">#[test_only]</span> will only be available to be called
from test code, but they themselves are not tests and will not be run as tests by the unit testing
framework.</p>
</blockquote>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test_only]</span><span class="token plain"> </span><span class="token comment" style="color:#A0A1A7">// test only attributes can be attached to modules</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">module abc { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test_only]</span><span class="token plain"> </span><span class="token comment" style="color:#A0A1A7">// test only attributes can be attached to constants</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token const const-keyword keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token const"> </span><span class="token const const-name constant" style="color:hsl(35, 99%, 36%)">MY_ADDR</span><span class="token const">: </span><span class="token const const-type support" style="color:#0184BC">address</span><span class="token const"> = @</span><span class="token const const-name constant" style="color:hsl(35, 99%, 36%)">0x1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test_only]</span><span class="token plain"> </span><span class="token comment" style="color:#A0A1A7">// .. to uses</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token use-import-fun use-keyword keyword" style="color:hsl(301, 63%, 40%)">use</span><span class="token use-import-fun"> pkg_addr</span><span class="token use-import-fun double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token use-import-fun">some_other_module;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test_only]</span><span class="token plain"> </span><span class="token comment" style="color:#A0A1A7">// .. to structs</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token struct-or-enum-definition struct-keyword keyword" style="color:hsl(301, 63%, 40%)">struct</span><span class="token struct-or-enum-definition"> </span><span class="token struct-or-enum-definition struct-name entity" style="color:#C18401">SomeStruct</span><span class="token struct-or-enum-definition"> {</span><span class="token plain"> ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test_only]</span><span class="token plain"> </span><span class="token comment" style="color:#A0A1A7">// .. and functions. Can only be called from test code, but this is _not_ a test!</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">test_only_function</span><span class="token plain">(...) { ... }</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="running-unit-tests">Running Unit Tests<a href="#running-unit-tests" class="hash-link" aria-label="Direct link to Running Unit Tests" title="Direct link to Running Unit Tests">​</a></h2>
<p>Use the <span class="inline-code">sui move test</span> command to run unit tests for a <a href="/reference/packages">Move package</a>.</p>
<p>When running tests, every test will either <span class="inline-code">PASS</span>, <span class="inline-code">FAIL</span>, or <span class="inline-code">TIMEOUT</span>. If a test case fails, the
location of the failure along with the function name that caused the failure will be reported if
possible. You can see an example of this below.</p>
<p>A test will be marked as timing out if it exceeds the maximum number of instructions that can be
executed for any single test. This bound can be changed using the options below. Additionally, while
the result of a test is always deterministic, tests are run in parallel by default, so the ordering
of test results in a test run is non-deterministic unless running with only one thread, which can be
configured via an option.</p>
<p>These aforementioned options are two among many that can fine-tune testing and help debug failing
tests. To see all available options, and a description of what each one does, pass the <span class="inline-code">--help</span> flag
to the <span class="inline-code">sui move test</span> command:</p>
<div class="language-text codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-text codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ sui move test --help</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h2>
<p>A simple module using some of the unit testing features is shown in the following example:</p>
<p>First create an empty package and change directory into it:</p>
<div class="language-bash codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-bash codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ sui move new test_example</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">cd</span><span class="token plain"> test_example</span><br></span></code></pre></div></div>
<p>Next add the following module under the <span class="inline-code">sources</span> directory:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token comment" style="color:#A0A1A7">// filename: sources/my_module.move</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">test_example</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">my_module</span><span class="token module-header">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token struct-or-enum-definition struct-keyword keyword" style="color:hsl(301, 63%, 40%)">struct</span><span class="token struct-or-enum-definition"> </span><span class="token struct-or-enum-definition struct-name entity" style="color:#C18401">Wrapper</span><span class="token struct-or-enum-definition">(</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token const const-keyword keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token const"> </span><span class="token const error-const-name error-const" style="color:#E45649">ECoinIsZero</span><span class="token const">: </span><span class="token const const-type support" style="color:#0184BC">u64</span><span class="token const"> = </span><span class="token const const-name constant" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">make_sure_non_zero_coin</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">coin</span><span class="token plain">: </span><span class="token struct-types entity" style="color:#C18401">Wrapper</span><span class="token plain">): </span><span class="token struct-types entity" style="color:#C18401">Wrapper</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(coin.</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> &gt; </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token error-const" style="color:#E45649">ECoinIsZero</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    coin</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">make_sure_non_zero_coin_passes</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> coin = </span><span class="token struct-types entity" style="color:#C18401">Wrapper</span><span class="token plain">(</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Wrapper</span><span class="token plain">(_) = </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">make_sure_non_zero_coin</span><span class="token plain">(coin);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(abort_code = ECoinIsZero)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:#A0A1A7">// Or #[test, expected_failure] if we don&#x27;t care about the abort code</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">make_sure_zero_coin_fails</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> coin = </span><span class="token struct-types entity" style="color:#C18401">Wrapper</span><span class="token plain">(</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Wrapper</span><span class="token plain">(_) = </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">make_sure_non_zero_coin</span><span class="token plain">(coin);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test_only]</span><span class="token plain"> </span><span class="token comment" style="color:#A0A1A7">// test only helper function</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">make_coin_zero</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">coin</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Wrapper</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    coin.</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> = </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[test, expected_failure(abort_code = ECoinIsZero)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">make_sure_zero_coin_fails2</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> coin = </span><span class="token struct-types entity" style="color:#C18401">Wrapper</span><span class="token plain">(</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">10</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    coin.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">make_coin_zero</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Wrapper</span><span class="token plain">(_) = </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">make_sure_non_zero_coin</span><span class="token plain">(coin);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="running-tests">Running Tests<a href="#running-tests" class="hash-link" aria-label="Direct link to Running Tests" title="Direct link to Running Tests">​</a></h3>
<p>You can then run these tests with the <span class="inline-code">move test</span> command:</p>
<div class="language-bash codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-bash codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ sui move </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY Bridge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY DeepBook</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY SuiSystem</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY Sui</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY MoveStdlib</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">BUILDING test_example</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Running Move unit tests</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> PASS    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> 0x0::my_module::make_sure_non_zero_coin_passes</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> PASS    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> 0x0::my_module::make_sure_zero_coin_fails</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> PASS    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> 0x0::my_module::make_sure_zero_coin_fails2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Test result: OK. Total tests: </span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> passed: </span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> failed: </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="using-test-flags">Using Test Flags<a href="#using-test-flags" class="hash-link" aria-label="Direct link to Using Test Flags" title="Direct link to Using Test Flags">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_kl3l" id="passing-specific-tests-to-run">Passing specific tests to run<a href="#passing-specific-tests-to-run" class="hash-link" aria-label="Direct link to Passing specific tests to run" title="Direct link to Passing specific tests to run">​</a></h4>
<p>You can run a specific test, or a set of tests with <span class="inline-code">sui move test &lt;str&gt;</span>. This will only run tests
whose fully qualified name contains <span class="inline-code">&lt;str&gt;</span>. For example if we wanted to only run tests with
<span class="inline-code">&quot;non_zero&quot;</span> in their name:</p>
<div class="language-bash codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-bash codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ sui move </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token plain"> non_zero</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY Bridge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY DeepBook</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY SuiSystem</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY Sui</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY MoveStdlib</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">BUILDING test_example</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Running Move unit tests</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> PASS    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> 0x0::my_module::make_sure_non_zero_coin_passes</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Test result: OK. Total tests: </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> passed: </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> failed: </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_kl3l" id="-i-bound-or---gas_used-bound"><span class="inline-code">-i &lt;bound&gt;</span> or <span class="inline-code">--gas_used &lt;bound&gt;</span><a href="#-i-bound-or---gas_used-bound" class="hash-link" aria-label="Direct link to -i-bound-or---gas_used-bound" title="Direct link to -i-bound-or---gas_used-bound">​</a></h4>
<p>This bounds the amount of gas that can be consumed for any one test to <span class="inline-code">&lt;bound&gt;</span>:</p>
<div class="language-bash codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-bash codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ sui move </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-i</span><span class="token plain"> </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY Bridge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY DeepBook</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY SuiSystem</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY Sui</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY MoveStdlib</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">BUILDING test_example</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Running Move unit tests</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> TIMEOUT </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> 0x0::my_module::make_sure_non_zero_coin_passes</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> FAIL    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> 0x0::my_module::make_sure_zero_coin_fails</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> FAIL    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> 0x0::my_module::make_sure_zero_coin_fails2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Test failures:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Failures </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> 0x0::my_module:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">┌── make_sure_non_zero_coin_passes ──────</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│ Test timed out</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">└──────────────────</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">┌── make_sure_zero_coin_fails ──────</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│ error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">E11001</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain">: </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token plain"> failure</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│    ┌─ ./sources/my_module.move:22:27</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│    │</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│ </span><span class="token number" style="color:hsl(35, 99%, 36%)">21</span><span class="token plain"> │     fun </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">make_sure_zero_coin_fails</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│    │         ------------------------- In this </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> 0x0::my_module</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│ </span><span class="token number" style="color:hsl(35, 99%, 36%)">22</span><span class="token plain"> │         </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">let</span><span class="token plain"> coin </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> MyCoin</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│    │                           ^ Test did not error as expected. Expected </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token plain"> to abort with code </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">SNIP</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">└──────────────────</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">┌── make_sure_zero_coin_fails2 ──────</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│ error</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain">E11001</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain">: </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token plain"> failure</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│    ┌─ ./sources/my_module.move:34:31</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│    │</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│ </span><span class="token number" style="color:hsl(35, 99%, 36%)">33</span><span class="token plain"> │     fun </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">make_sure_zero_coin_fails2</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│    │         -------------------------- In this </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">function</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(301, 63%, 40%)">in</span><span class="token plain"> 0x0::my_module</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│ </span><span class="token number" style="color:hsl(35, 99%, 36%)">34</span><span class="token plain"> │         </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">let</span><span class="token plain"> mut coin </span><span class="token operator" style="color:hsl(221, 87%, 60%)">=</span><span class="token plain"> MyCoin</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">(</span><span class="token number" style="color:hsl(35, 99%, 36%)">10</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">)</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│    │                               ^^ Test did not error as expected. Expected </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token plain"> to abort with code </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain"> </span><span class="token operator" style="color:hsl(221, 87%, 60%)">&lt;</span><span class="token plain">SNIP</span><span class="token operator" style="color:hsl(221, 87%, 60%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">└──────────────────</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Test result: FAILED. Total tests: </span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> passed: </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> failed: </span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_kl3l" id="-s-or---statistics"><span class="inline-code">-s</span> or <span class="inline-code">--statistics</span><a href="#-s-or---statistics" class="hash-link" aria-label="Direct link to -s-or---statistics" title="Direct link to -s-or---statistics">​</a></h4>
<p>With these flags you can gather statistics about the tests run and report the runtime and gas used
for each test. You can additionally add <span class="inline-code">csv</span> (<span class="inline-code">sui move test -s csv</span>) to get the gas usage in a csv
output format. For example, if we wanted to see the statistics for the tests in the example above:</p>
<div class="language-bash codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-bash codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">$ sui move </span><span class="token builtin class-name" style="color:hsl(35, 99%, 36%)">test</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(221, 87%, 60%)">-s</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY Bridge</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY DeepBook</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY SuiSystem</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY Sui</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">INCLUDING DEPENDENCY MoveStdlib</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">BUILDING test_example</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Running Move unit tests</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> PASS    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> 0x0::my_module::make_sure_non_zero_coin_passes</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> PASS    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> 0x0::my_module::make_sure_zero_coin_fails</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">[</span><span class="token plain"> PASS    </span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">]</span><span class="token plain"> 0x0::my_module::make_sure_zero_coin_fails2</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Test Statistics:</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">┌────────────────────────────────────────────────┬────────────┬───────────────────────────┐</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│                   Test Name                    │    Time    │         Gas Used          │</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">├────────────────────────────────────────────────┼────────────┼───────────────────────────┤</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│ 0x0::my_module::make_sure_non_zero_coin_passes │   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0.001</span><span class="token plain">    │             </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">             │</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">├────────────────────────────────────────────────┼────────────┼───────────────────────────┤</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│ 0x0::my_module::make_sure_zero_coin_fails      │   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0.001</span><span class="token plain">    │             </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">             │</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">├────────────────────────────────────────────────┼────────────┼───────────────────────────┤</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">│ 0x0::my_module::make_sure_zero_coin_fails2     │   </span><span class="token number" style="color:hsl(35, 99%, 36%)">0.001</span><span class="token plain">    │             </span><span class="token number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">             │</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">└────────────────────────────────────────────────┴────────────┴───────────────────────────┘</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Test result: OK. Total tests: </span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> passed: </span><span class="token number" style="color:hsl(35, 99%, 36%)">3</span><span class="token punctuation" style="color:hsl(119, 34%, 47%)">;</span><span class="token plain"> failed: </span><span class="token number" style="color:hsl(35, 99%, 36%)">0</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/reference/packages"><div class="pagination-nav__label"><i class="fa fa-angle-left"></i><span class="pagination-nav__label">16. Packages</span> </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/reference/coding-conventions"><div class="pagination-nav__label"><span class="pagination-nav__label">18. Coding Conventions</span> <i class="fa fa-angle-right"></i></div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_VdoB thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#test-annotations" class="table-of-contents__link toc-highlight">Test Annotations</a></li><li><a href="#expected-failures" class="table-of-contents__link toc-highlight">Expected Failures</a><ul><li><a href="#1-expected_failureabort_code--constant" class="table-of-contents__link toc-highlight">1. <code>#[expected_failure(abort_code = &lt;constant&gt;)]</code></a></li><li><a href="#2-expected_failurearithmetic_error-location--location" class="table-of-contents__link toc-highlight">2. <code>#[expected_failure(arithmetic_error, location = &lt;location&gt;)]</code></a></li><li><a href="#3-expected_failureout_of_gas-location--location" class="table-of-contents__link toc-highlight">3. <code>#[expected_failure(out_of_gas, location = &lt;location&gt;)]</code></a></li><li><a href="#4-expected_failurevector_error-minor_status--u64_opt-location--location" class="table-of-contents__link toc-highlight">4. <code>#[expected_failure(vector_error, minor_status = &lt;u64_opt&gt;, location = &lt;location&gt;)]</code></a></li><li><a href="#5-expected_failure" class="table-of-contents__link toc-highlight">5. <code>#[expected_failure]</code></a></li></ul></li><li><a href="#test-only-annotations" class="table-of-contents__link toc-highlight">Test Only Annotations</a></li><li><a href="#running-unit-tests" class="table-of-contents__link toc-highlight">Running Unit Tests</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a><ul><li><a href="#running-tests" class="table-of-contents__link toc-highlight">Running Tests</a></li><li><a href="#using-test-flags" class="table-of-contents__link toc-highlight">Using Test Flags</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>