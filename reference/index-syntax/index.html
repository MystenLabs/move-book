<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-reference docs-version-current docs-doc-page docs-doc-id-index-syntax" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Index Syntax | Reference | The Move Book</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://move-book.com/reference/index-syntax"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="algolia-site-verification" content="BCA21DA2879818D2"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-reference-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-reference-current"><meta data-rh="true" property="og:title" content="Index Syntax | Reference | The Move Book"><link data-rh="true" rel="icon" href="/favicon.svg"><link data-rh="true" rel="canonical" href="https://move-book.com/reference/index-syntax"><link data-rh="true" rel="alternate" href="https://move-book.com/reference/index-syntax" hreflang="en"><link data-rh="true" rel="alternate" href="https://move-book.com/reference/index-syntax" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1E7R0BHX4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B1E7R0BHX4",{anonymize_ip:!0})</script>



<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Rubik:wght@300&amp;amp;display=swap">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/styles.d505040f.css">
<script src="/assets/js/runtime~main.b2771f81.js" defer="defer"></script>
<script src="/assets/js/main.4b3a728b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_OH5z" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a><a class="navbar__item navbar__link" href="/">Move Book</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/reference">Move Reference</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_aspp"><div class="navbar__search searchBarContainer_reza" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_Kpxf" value=""><div class="loadingRing_LRD_ searchBarLoadingRing_lY7z"><div></div><div></div><div></div><div></div></div></div></div><a href="https://github.com/MystenLabs/move-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><i class="fab fa-github"></i></a><div class="toggle_MW0i colorModeToggle_RHuM"><button class="clean-btn toggleButton_yw5v toggleButtonDisabled_BJd7" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><i aria-hidden="true" class="toggleIcon_oIOL lightToggleIcon_SFTY fas fa-moon"></i><i aria-hidden="true" class="toggleIcon_oIOL darkToggleIcon_ekgs fas fa-sun"></i><i aria-hidden="true" class="toggleIcon_oIOL systemToggleIcon_yi_a fas fa-moon"></i></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_wWoK"><div class="docsWrapper_nrtX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_xs6u" type="button"></button><div class="docRoot_XRUv"><aside class="theme-doc-sidebar-container docSidebarContainer_vhZZ"><div class="sidebarViewport_HXJ_"><div class="sidebar_B2tA"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_RelJ"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/reference/">The Move Reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Getting Started</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/modules">1. Modules</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Basic Concepts</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/primitive-types">2. Primitive Types</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/integers">2.1 Integers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/bool">2.2 Bool</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/address">2.3 Address</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/vector">2.4 Vector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/references">2.5 References</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/tuples">2.6 Tuples and Unit</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/variables">3. Local Variables and Scopes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/equality">4. Equality</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/abort-and-assert">5. Abort and Assert</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/abort-and-assert/clever-errors">5.1 Clever Errors</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/control-flow">6. Control Flow</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/conditionals">6.1 Conditional Expressions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/loops">6.2 Loops</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/labeled-control-flow">6.3 Labeled Control Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/pattern-matching">6.4 Pattern Matching</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/functions">7. Functions</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/functions/macros">7.1 Macros</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/structs">8. Structs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/enums">9. Enums</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/constants">10. Constants</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/generics">11. Generics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/abilities">12. Abilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/uses">13. Uses and Aliases</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Advanced Concepts</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/method-syntax">14. Method Syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reference/index-syntax">15. Index Syntax</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Tooling</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/packages">16. Packages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/unit-testing">17. Unit Testing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Reference</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/coding-conventions">18. Coding Conventions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Deprecated</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/friends">19. Friends</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_oT2n"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_LCKf"><div class="docItemContainer_Jixr"><article><div class="tocCollapsible_vYTS theme-doc-toc-mobile tocMobile_QhsY"><button type="button" class="clean-btn tocCollapsibleButton_nB9w">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Index Syntax</h1></header>
<p>Move provides syntax attributes to allow you to define operations that look and feel like native
Move code, lowering these operations into your user-provided definitions.</p>
<p>Our first syntax method, <span class="inline-code">index</span>, allows you to define a group of operations that can be used as
custom index accessors for your datatypes, such as accessing a matrix element as <span class="inline-code">m[i,j]</span>, by
annotating functions that should be used for these index operations. Moreover, these definitions are
bespoke per-type and available implicitly for any programmer using your type.</p>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="overview-and-summary">Overview and Summary<a href="#overview-and-summary" class="hash-link" aria-label="Direct link to Overview and Summary" title="Direct link to Overview and Summary">​</a></h2>
<p>To start, consider a <span class="inline-code">Matrix</span> type that uses a vector of vectors to represent its values. You can
write a small library using <span class="inline-code">index</span> syntax annotations on the <span class="inline-code">borrow</span> and <span class="inline-code">borrow_mut</span> functions as
follows:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">matrix</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">matrix</span><span class="token module-header">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token struct-or-enum-definition struct-keyword keyword" style="color:hsl(301, 63%, 40%)">struct</span><span class="token struct-or-enum-definition"> </span><span class="token struct-or-enum-definition struct-name entity" style="color:#C18401">Matrix</span><span class="token struct-or-enum-definition">&lt;</span><span class="token struct-or-enum-definition struct-name entity" style="color:#C18401">T</span><span class="token struct-or-enum-definition">&gt; {</span><span class="token plain"> </span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;&gt; }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">s</span><span class="token plain">: &amp;</span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): &amp;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">(</span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">(&amp;s.v, i), j)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_mut</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">s</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow_mut</span><span class="token plain">(</span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow_mut</span><span class="token plain">(&amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> s.v, i), j)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">make_matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;&gt;):  </span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt; {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain"> { v }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Now anyone using this <span class="inline-code">Matrix</span> type has access to index syntax for it:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> m = matrix::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">make_matrix</span><span class="token plain">(</span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">[</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">[</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">],</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">[</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">],</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">[</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">],</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">]);x</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> i = </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> (i &lt; </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">3</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> j = </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> (j &lt; </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">3</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (i == j) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(m[i, j] == </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        } </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(m[i, j] == </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        };</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        *(&amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> m[i,j]) = </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        j = j + </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    };</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    i = i + </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h2>
<p>As the example indicates, if you define a datatype and an associated index syntax method, anyone can
invoke that method by writing index syntax on a value of that type:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> mat = matrix::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">make_matrix</span><span class="token plain">(...);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> m_0_0 = mat[</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">];</span><br></span></code></pre></div></div>
<p>During compilation, the compiler translates these into the appropriate function invocations based on
the position and mutable usage of the expression:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> mat = matrix::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">make_matrix</span><span class="token plain">(...);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> m_0_0 = mat[</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:#A0A1A7">// translates to `copy matrix::borrow(&amp;mat, 0, 0)`</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> m_0_0 = &amp;mat[</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:#A0A1A7">// translates to `matrix::borrow(&amp;mat, 0, 0)`</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> m_0_0 = &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> mat[</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:#A0A1A7">// translates to `matrix::borrow_mut(&amp;mut mat, 0, 0)`</span><br></span></code></pre></div></div>
<p>You can also intermix index expressions with field accesses:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token struct-or-enum-definition struct-keyword keyword" style="color:hsl(301, 63%, 40%)">struct</span><span class="token struct-or-enum-definition"> </span><span class="token struct-or-enum-definition struct-name entity" style="color:#C18401">V</span><span class="token struct-or-enum-definition"> {</span><span class="token plain"> </span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt; }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token struct-or-enum-definition struct-keyword keyword" style="color:hsl(301, 63%, 40%)">struct</span><span class="token struct-or-enum-definition"> </span><span class="token struct-or-enum-definition struct-name entity" style="color:#C18401">Vs</span><span class="token struct-or-enum-definition"> {</span><span class="token plain"> </span><span class="token property-name function-argument struct-property-name">vs</span><span class="token plain">: </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">V</span><span class="token plain">&gt; }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_first</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">input</span><span class="token plain">: &amp;</span><span class="token struct-types entity" style="color:#C18401">Vs</span><span class="token plain">): &amp;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    &amp;input.vs[</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">].v[</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">]</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// translates to `vector::borrow(&amp;vector::borrow(&amp;input.vs, 0).v, 0)`</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="index-functions-take-flexible-arguments">Index Functions Take Flexible Arguments<a href="#index-functions-take-flexible-arguments" class="hash-link" aria-label="Direct link to Index Functions Take Flexible Arguments" title="Direct link to Index Functions Take Flexible Arguments">​</a></h3>
<p>Note that, aside from the definition and type limitations described in the rest of this chapter,
Move places no restrictions on the values your index syntax method takes as parameters. This allows
you to implement intricate programmatic behavior when defining index syntax, such as a data
structure that takes a default value if the index is out of bounds:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_or_set</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">Key</span><span class="token plain">: </span><span class="token abilities support" style="color:#0184BC">copy</span><span class="token plain">, </span><span class="token struct-types entity" style="color:#C18401">Value</span><span class="token plain">: </span><span class="token abilities support" style="color:#0184BC">drop</span><span class="token plain">&gt;(</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property-name function-argument struct-property-name">input</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">MTable</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">Key</span><span class="token plain">, </span><span class="token struct-types entity" style="color:#C18401">Value</span><span class="token plain">&gt;,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token abilities support" style="color:#0184BC">key</span><span class="token plain">: </span><span class="token struct-types entity" style="color:#C18401">Key</span><span class="token plain">,</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token property-name function-argument struct-property-name">default</span><span class="token plain">: </span><span class="token struct-types entity" style="color:#C18401">Value</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">): &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Value</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">contains</span><span class="token plain">(input, </span><span class="token abilities support" style="color:#0184BC">key</span><span class="token plain">)) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">(input, </span><span class="token abilities support" style="color:#0184BC">key</span><span class="token plain">)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    } </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">insert</span><span class="token plain">(input, </span><span class="token abilities support" style="color:#0184BC">key</span><span class="token plain">, default);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">(input, </span><span class="token abilities support" style="color:#0184BC">key</span><span class="token plain">)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Now, when you index into <span class="inline-code">MTable</span>, you must also provide a default value:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token let-statement">string_key</span><span class="token plain">: </span><span class="token struct-types entity" style="color:#C18401">String</span><span class="token plain"> = ...;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token let-statement">table</span><span class="token plain">: </span><span class="token struct-types entity" style="color:#C18401">MTable</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">String</span><span class="token plain">, </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt; = m_table::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">make_table</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">entry</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain"> = &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> table[string_key, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">];</span><br></span></code></pre></div></div>
<p>This sort of extensible power allows you to write precise index interfaces for your types,
concretely enforcing bespoke behavior.</p>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="defining-index-syntax-functions">Defining Index Syntax Functions<a href="#defining-index-syntax-functions" class="hash-link" aria-label="Direct link to Defining Index Syntax Functions" title="Direct link to Defining Index Syntax Functions">​</a></h2>
<p>This powerful syntax form allows all of your user-defined datatypes to behave in this way, assuming
your definitions adhere to the following rules:</p>
<ol>
<li>The <span class="inline-code">#[syntax(index)]</span> attribute is added to the designated functions defined in the same module
as the subject type.</li>
<li>The designated functions have <span class="inline-code">public</span> visibility.</li>
<li>The functions take a reference type as its subject type (its first argument) and returns a
matching references type (<span class="inline-code">mut</span> if the subject was <span class="inline-code">mut</span>).</li>
<li>Each type has only a single mutable and single immutable definition.</li>
<li>Immutable and mutable versions have type agreement:<!-- -->
<ul>
<li>The subject types match, differing only in mutability.</li>
<li>The return types match the mutability of their subject types.</li>
<li>Type parameters, if present, have identical constraints between both versions.</li>
<li>All parameters beyond the subject type are identical.</li>
</ul>
</li>
</ol>
<p>The following content and additional examples describe these rules in greater detail.</p>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="declaration">Declaration<a href="#declaration" class="hash-link" aria-label="Direct link to Declaration" title="Direct link to Declaration">​</a></h3>
<p>To declare an index syntax method, add the <span class="inline-code">#[syntax(index)]</span> attribute above the relevant function
definition in the same module as the subject type&#x27;s definition. This signals to the compiler that
the function is an index accessor for the specified type.</p>
<h4 class="anchor anchorWithStickyNavbar_kl3l" id="immutable-accessor">Immutable Accessor<a href="#immutable-accessor" class="hash-link" aria-label="Direct link to Immutable Accessor" title="Direct link to Immutable Accessor">​</a></h4>
<p>The immutable index syntax method is defined for read-only access. It takes an immutable reference
of the subject type and returns an immutable reference to the element type. The <span class="inline-code">borrow</span> function
defined in <span class="inline-code">std::vector</span> is an example of this:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">native</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">Element</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: &amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">Element</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): &amp;</span><span class="token struct-types entity" style="color:#C18401">Element</span><span class="token plain">;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_kl3l" id="mutable-accessor">Mutable Accessor<a href="#mutable-accessor" class="hash-link" aria-label="Direct link to Mutable Accessor" title="Direct link to Mutable Accessor">​</a></h4>
<p>The mutable index syntax method is the dual of the immutable one, allowing for both read and write
operations. It takes a mutable reference of the subject type and returns a mutable reference to the
element type. The <span class="inline-code">borrow_mut</span> function defined in <span class="inline-code">std::vector</span> is an example of this:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">native</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_mut</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">Element</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">Element</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Element</span><span class="token plain">;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_kl3l" id="visibility">Visibility<a href="#visibility" class="hash-link" aria-label="Direct link to Visibility" title="Direct link to Visibility">​</a></h4>
<p>To ensure that indexing functions are available anywhere the type is used, all index syntax methods
must have public visibility. This ensures ergonomic usage of indexing across modules and packages in
Move.</p>
<h4 class="anchor anchorWithStickyNavbar_kl3l" id="no-duplicates">No Duplicates<a href="#no-duplicates" class="hash-link" aria-label="Direct link to No Duplicates" title="Direct link to No Duplicates">​</a></h4>
<p>In addition to the above requirements, we restrict each subject base type to defining a single index
syntax method for immutable references and a single index syntax method for mutable references. For
example, you cannot define a specialized version for a polymorphic type:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_matrix_u64</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">s</span><span class="token plain">: &amp;</span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): &amp;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">s</span><span class="token plain">: &amp;</span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): &amp;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// ERROR! Matrix already has a definition</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// for its immutable index syntax method</span><br></span></code></pre></div></div>
<p>This ensures that you can always tell which method is being invoked, without the need to inspect
type instantiation.</p>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="type-constraints">Type Constraints<a href="#type-constraints" class="hash-link" aria-label="Direct link to Type Constraints" title="Direct link to Type Constraints">​</a></h3>
<p>By default, an index syntax method has the following type constraints:</p>
<p><strong>Its subject type (first argument) must be a reference to a single type defined in the same module
as the marked function.</strong> This means that you cannot define index syntax methods for tuples, type
parameters, or values:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_fst</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">x</span><span class="token plain">: &amp;(</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">), ...): &amp;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// ERROR because the subject type is a tuple</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_tyarg</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">x</span><span class="token plain">: &amp;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">, ...): &amp;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// ERROR because the subject type is a type parameter</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_value</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">x</span><span class="token plain">: </span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;, ...): &amp;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// ERROR because x is not a reference</span><br></span></code></pre></div></div>
<p><strong>The subject type must match mutability with the return type.</strong> This restriction allows you to
clarify the expected behavior when borrowing an indexed expression as <span class="inline-code">&amp;vec[i]</span> versus
<span class="inline-code">&amp;mut vec[i]</span>. The Move compiler uses the mutability marker to determine which borrow form to call
to produce a reference of the appropriate mutability. As a result, we disallow index syntax methods
whose subject and return mutability differ:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_imm</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">x</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;, ...): &amp;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// ERROR! incompatible mutability</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// expected a mutable reference &#x27;&amp;mut&#x27; return type</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="type-compatibility">Type Compatibility<a href="#type-compatibility" class="hash-link" aria-label="Direct link to Type Compatibility" title="Direct link to Type Compatibility">​</a></h3>
<p>When defining an immutable and mutable index syntax method pair, they are subject to a number of
compatibility constraints:</p>
<ol>
<li>They must take the same number of type parameters, those type parameters must have the same
constraints.</li>
<li>Type parameters must be used the same <em>by position</em>, not name.</li>
<li>Their subject types must match exactly except for the mutability.</li>
<li>Their return types must match exactly except for the mutability.</li>
<li>All other parameter types must match exactly.</li>
</ol>
<p>These constraints are to ensure that index syntax behaves identically regardless of being in a
mutable or immutable position.</p>
<p>To illustrate some of these errors, recall the previous <span class="inline-code">Matrix</span> definition:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">s</span><span class="token plain">: &amp;</span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): &amp;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">(</span><span class="token built-in-types support" style="color:#0184BC">vector</span><span class="token plain">::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">(&amp;s.v, i), j)</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>All of the following are type-incompatible definitions of the mutable version:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_mut</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">: </span><span class="token abilities support" style="color:#0184BC">drop</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">s</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// ERROR! `T` has `drop` here, but no in the immutable version</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_mut</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">s</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// ERROR! This takes a different number of type parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_mut</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">, </span><span class="token struct-types entity" style="color:#C18401">U</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">s</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">U</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">U</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// ERROR! This takes a different number of type parameters</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_mut</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">U</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">s</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">U</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i_j</span><span class="token plain">: (</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">)): &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">U</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// ERROR! This takes a different number of arguments</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token attribute attr-name" style="color:hsl(35, 99%, 36%)">#[syntax(index)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">borrow_mut</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">U</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">s</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">Matrix</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">U</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u32</span><span class="token plain">): &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token struct-types entity" style="color:#C18401">U</span><span class="token plain"> { ... }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token comment" style="color:#A0A1A7">// ERROR! `j` is a different type</span><br></span></code></pre></div></div>
<p>Again, the goal here is to make the usage across the immutable and mutable versions consistent. This
allows index syntax methods to work without changing out the behavior or constraints based on
mutable versus immutable usage, ultimately ensuring a consistent interface to program against.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/reference/method-syntax"><div class="pagination-nav__label"><i class="fa fa-angle-left"></i><span class="pagination-nav__label">14. Method Syntax</span> </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/reference/packages"><div class="pagination-nav__label"><span class="pagination-nav__label">16. Packages</span> <i class="fa fa-angle-right"></i></div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_VdoB thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview-and-summary" class="table-of-contents__link toc-highlight">Overview and Summary</a></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a><ul><li><a href="#index-functions-take-flexible-arguments" class="table-of-contents__link toc-highlight">Index Functions Take Flexible Arguments</a></li></ul></li><li><a href="#defining-index-syntax-functions" class="table-of-contents__link toc-highlight">Defining Index Syntax Functions</a><ul><li><a href="#declaration" class="table-of-contents__link toc-highlight">Declaration</a></li><li><a href="#type-constraints" class="table-of-contents__link toc-highlight">Type Constraints</a></li><li><a href="#type-compatibility" class="table-of-contents__link toc-highlight">Type Compatibility</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>