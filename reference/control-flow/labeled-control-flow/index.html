<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-reference docs-version-current docs-doc-page docs-doc-id-control-flow/labeled-control-flow" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Labeled Control Flow | Reference | The Move Book</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://move-book.com/reference/control-flow/labeled-control-flow"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="algolia-site-verification" content="BCA21DA2879818D2"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-reference-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-reference-current"><meta data-rh="true" property="og:title" content="Labeled Control Flow | Reference | The Move Book"><link data-rh="true" rel="icon" href="/favicon.svg"><link data-rh="true" rel="canonical" href="https://move-book.com/reference/control-flow/labeled-control-flow"><link data-rh="true" rel="alternate" href="https://move-book.com/reference/control-flow/labeled-control-flow" hreflang="en"><link data-rh="true" rel="alternate" href="https://move-book.com/reference/control-flow/labeled-control-flow" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1E7R0BHX4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B1E7R0BHX4",{anonymize_ip:!0})</script>



<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Rubik:wght@300&amp;amp;display=swap">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/styles.f79f3242.css">
<script src="/assets/js/runtime~main.2afa8533.js" defer="defer"></script>
<script src="/assets/js/main.07a9ebc7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_OH5z" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a><a class="navbar__item navbar__link" href="/">Move Book</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/reference">Move Reference</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_aspp"><div class="navbar__search searchBarContainer_reza" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_Kpxf" value=""><div class="loadingRing_LRD_ searchBarLoadingRing_lY7z"><div></div><div></div><div></div><div></div></div></div></div><a href="https://github.com/MystenLabs/move-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><i class="fab fa-github"></i></a><div class="toggle_MW0i colorModeToggle_RHuM"><button class="clean-btn toggleButton_yw5v toggleButtonDisabled_BJd7" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><i aria-hidden="true" class="toggleIcon_oIOL lightToggleIcon_SFTY fas fa-moon"></i><i aria-hidden="true" class="toggleIcon_oIOL darkToggleIcon_ekgs fas fa-sun"></i><i aria-hidden="true" class="toggleIcon_oIOL systemToggleIcon_yi_a fas fa-moon"></i></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_wWoK"><div class="docsWrapper_nrtX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_xs6u" type="button"></button><div class="docRoot_XRUv"><aside class="theme-doc-sidebar-container docSidebarContainer_vhZZ"><div class="sidebarViewport_HXJ_"><div class="sidebar_B2tA"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_RelJ"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/reference/">The Move Reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Getting Started</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/modules">1. Modules</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Basic Concepts</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/primitive-types">2. Primitive Types</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/integers">2.1 Integers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/bool">2.2 Bool</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/address">2.3 Address</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/vector">2.4 Vector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/references">2.5 References</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/tuples">2.6 Tuples and Unit</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/variables">3. Local Variables and Scopes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/equality">4. Equality</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/abort-and-assert">5. Abort and Assert</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/abort-and-assert/clever-errors">5.1 Clever Errors</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" tabindex="0" href="/reference/control-flow">6. Control Flow</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/conditionals">6.1 Conditional Expressions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/loops">6.2 Loops</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reference/control-flow/labeled-control-flow">6.3 Labeled Control Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/pattern-matching">6.4 Pattern Matching</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/functions">7. Functions</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/functions/macros">7.1 Macros</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/structs">8. Structs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/enums">9. Enums</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/constants">10. Constants</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/generics">11. Generics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/abilities">12. Abilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/uses">13. Uses and Aliases</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Advanced Concepts</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/method-syntax">14. Method Syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/index-syntax">15. Index Syntax</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Tooling</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/packages">16. Packages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/unit-testing">17. Unit Testing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Reference</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/coding-conventions">18. Coding Conventions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Deprecated</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/friends">19. Friends</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_oT2n"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_LCKf"><div class="docItemContainer_Jixr"><article><div class="tocCollapsible_vYTS theme-doc-toc-mobile tocMobile_QhsY"><button type="button" class="clean-btn tocCollapsibleButton_nB9w">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Labeled Control Flow</h1></header>
<p>Move supports labeled control flow when writing both loops and blocks of code, allowing you
to <span class="inline-code">break</span> and <span class="inline-code">continue</span> loops and <span class="inline-code">return</span> from blocks (which can be particularly helpful in the
presence of macros).</p>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="loops">Loops<a href="#loops" class="hash-link" aria-label="Direct link to Loops" title="Direct link to Loops">​</a></h2>
<p>Loops allow you to define and transfer control to specific labels in a function. For example, we can
nest two loops and use <span class="inline-code">break</span> and <span class="inline-code">continue</span> with those labels to precisely specify control flow.
You can prefix any <span class="inline-code">loop</span> or <span class="inline-code">while</span> form with a <span class="inline-code">&#x27;label:</span> form to allow breaking or continuing
directly there.</p>
<p>To demonstrate this behavior, consider a function that takes nested vectors of numbers (i.e.,
<span class="inline-code">vector&lt;vector&lt;u64&gt;&gt;</span>) to sum against some threshold, which behaves as follows:</p>
<ul>
<li>If the sum of all the numbers are under the threshold, return that sum.</li>
<li>If adding a number to the current sum would surpass the threshold, return the current sum.</li>
</ul>
<p>We can write this by iterating over the vector of vectors as nested loops and labelling the outer
one. If any addition in the inner loop would push us over the threshold, we can use <span class="inline-code">break</span> with the
outer label to escape both loops at once:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">sum_until_threshold</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">input</span><span class="token plain">: &amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;&gt;, </span><span class="token property-name function-argument struct-property-name">threshold</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> sum = </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> i = </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> input_size = input.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">length</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token label string" style="color:hsl(119, 34%, 47%)">&#x27;outer:</span><span class="token plain"> </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">loop</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token comment" style="color:#A0A1A7">// breaks to outer since it is the closest enclosing loop</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (i &gt;= input_size) </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">break</span><span class="token plain"> sum;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> vec = &amp;input[i];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> size = vec.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">length</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> j = </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> (j &lt; size) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> v_entry = vec[j];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (sum + </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">v_entry</span><span class="token plain"> &lt; threshold) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                sum = sum + v_entry;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            } </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:#A0A1A7">// the next element we saw would break the threshold,</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token comment" style="color:#A0A1A7">// so we return the current sum</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">break</span><span class="token plain"> &#x27;outer sum</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            };</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            j = j + </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        };</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        i = i + </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>These sorts of labels can also be used with a nested loop form, providing precise control in larger
bodies of code. For example, if we were processing a large table where each entry required iteration
that might see us continuing the inner or outer loop, we could express that code using labels:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> x = </span><span class="token label string" style="color:hsl(119, 34%, 47%)">&#x27;outer:</span><span class="token plain"> </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">loop</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token label string" style="color:hsl(119, 34%, 47%)">&#x27;inner:</span><span class="token plain"> </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> (cond) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (cond0) { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">break</span><span class="token plain"> &#x27;outer value };</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (cond1) { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">continue</span><span class="token plain"> &#x27;inner }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (cond2) { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">continue</span><span class="token plain"> &#x27;outer }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">};</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="labeled-blocks">Labeled Blocks<a href="#labeled-blocks" class="hash-link" aria-label="Direct link to Labeled Blocks" title="Direct link to Labeled Blocks">​</a></h2>
<p>Labeled blocks allow you to write Move programs that contain intra-function non-local control flow,
including inside of macro lambdas and returning values:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">named_return</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">n</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u8</span><span class="token plain">&gt; {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> x = </span><span class="token label string" style="color:hsl(119, 34%, 47%)">&#x27;a:</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (n % </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> == </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> &#x27;a </span><span class="token string-literal string-literal-prefix">b&quot;</span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)">even</span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)"></span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)"></span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)"></span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)"></span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)"></span><span class="token string-literal">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        };</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token string-literal string-literal-prefix">b&quot;</span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)">odd</span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)"></span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)"></span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)"></span><span class="token string-literal string-literal-content string" style="color:hsl(119, 34%, 47%)"></span><span class="token string-literal">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    };</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    x</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>In this simple example, the program checks if the input <span class="inline-code">n</span> is even. If it is, the program leaves
the block labeled <span class="inline-code">&#x27;a:</span> with the value <span class="inline-code">b&quot;even&quot;</span>. If not, the code continues, ending the block
labeled <span class="inline-code">&#x27;a:</span> with the value <span class="inline-code">b&quot;odd&quot;</span>. At the end, we set <span class="inline-code">x</span> to the value and then return it.</p>
<p>This control flow feature works across macro bodies as well. For example, suppose we wanted to write
a function to find the first even number in a vector, and that we have some macro <span class="inline-code">for_ref</span> that
iterates the vector elements in a loop:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token macro keyword" style="color:hsl(301, 63%, 40%)">macro</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">for_ref</span><span class="token plain">&lt;</span><span class="token macro-variable builtin" style="color:hsl(119, 34%, 47%)">$T</span><span class="token plain">&gt;(</span><span class="token macro-variable builtin" style="color:hsl(119, 34%, 47%)">$vs</span><span class="token plain">: &amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token macro-variable builtin" style="color:hsl(119, 34%, 47%)">$T</span><span class="token plain">&gt;, </span><span class="token macro-variable builtin" style="color:hsl(119, 34%, 47%)">$f</span><span class="token plain">: |&amp;</span><span class="token macro-variable builtin" style="color:hsl(119, 34%, 47%)">$T</span><span class="token plain">|) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> vs = </span><span class="token macro-variable builtin" style="color:hsl(119, 34%, 47%)">$vs</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> i = </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> end = vs.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">length</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> (i &lt; end) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token macro-variable builtin" style="color:hsl(119, 34%, 47%)">$f</span><span class="token plain">(vs.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">borrow</span><span class="token plain">(i));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        i = i + </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Using <span class="inline-code">for_ref</span> and a label, we can write a lambda expression to pass <span class="inline-code">for_ref</span> that will escape the
loop, returning the first even number it finds:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">find_first_even</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">vs</span><span class="token plain">: </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;): </span><span class="token struct-types entity" style="color:#C18401">Option</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt; {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token label string" style="color:hsl(119, 34%, 47%)">&#x27;result:</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token macro-call macro-name support" style="color:#0184BC">for_ref</span><span class="token macro-call">!</span><span class="token plain">(&amp;vs, |n| </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (*n % </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain"> == </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">) { </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> &#x27;result option::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">some</span><span class="token plain">(*n)});</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        option::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">none</span><span class="token plain">()</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>This function will iterate <span class="inline-code">vs</span> until it finds an even number, and return that (or return
<span class="inline-code">option::none()</span> if no even number exists). This makes named labels a powerful tool for interacting
with control flow macros such as <span class="inline-code">for!</span>, allowing you to customize iteration behavior in those
contexts.</p>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="restrictions">Restrictions<a href="#restrictions" class="hash-link" aria-label="Direct link to Restrictions" title="Direct link to Restrictions">​</a></h2>
<p>To clarify program behavior, you may only use <span class="inline-code">break</span> and <span class="inline-code">continue</span> with loop labels, while
<span class="inline-code">return</span> will only work with block labels. To this end, the following programs produce errors:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">bad_loop</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token label string" style="color:hsl(119, 34%, 47%)">&#x27;name:</span><span class="token plain"> </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">loop</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">return</span><span class="token plain"> &#x27;name </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            </span><span class="token comment" style="color:#A0A1A7">// ^^^^^ Invalid usage of &#x27;return&#x27; with a loop block label</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">bad_block</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token label string" style="color:hsl(119, 34%, 47%)">&#x27;name:</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">continue</span><span class="token plain"> &#x27;name;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">              </span><span class="token comment" style="color:#A0A1A7">// ^^^^^ Invalid usage of &#x27;break&#x27; with a loop block label</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">break</span><span class="token plain"> &#x27;name;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">           </span><span class="token comment" style="color:#A0A1A7">// ^^^^^ Invalid usage of &#x27;break&#x27; with a loop block label</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/reference/control-flow/loops"><div class="pagination-nav__label"><i class="fa fa-angle-left"></i><span class="pagination-nav__label">6.2 Loops</span> </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/reference/control-flow/pattern-matching"><div class="pagination-nav__label"><span class="pagination-nav__label">6.4 Pattern Matching</span> <i class="fa fa-angle-right"></i></div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_VdoB thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#loops" class="table-of-contents__link toc-highlight">Loops</a></li><li><a href="#labeled-blocks" class="table-of-contents__link toc-highlight">Labeled Blocks</a></li><li><a href="#restrictions" class="table-of-contents__link toc-highlight">Restrictions</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>