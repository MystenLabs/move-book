<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-reference docs-version-current docs-doc-page docs-doc-id-abort-and-assert" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Abort and Assert | Reference | The Move Book</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://move-book.com/reference/abort-and-assert"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="algolia-site-verification" content="BCA21DA2879818D2"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-reference-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-reference-current"><meta data-rh="true" property="og:title" content="Abort and Assert | Reference | The Move Book"><link data-rh="true" rel="icon" href="/favicon.svg"><link data-rh="true" rel="canonical" href="https://move-book.com/reference/abort-and-assert"><link data-rh="true" rel="alternate" href="https://move-book.com/reference/abort-and-assert" hreflang="en"><link data-rh="true" rel="alternate" href="https://move-book.com/reference/abort-and-assert" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1E7R0BHX4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B1E7R0BHX4",{anonymize_ip:!0})</script>



<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Rubik:wght@300&amp;amp;display=swap">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/styles.4d9dba2f.css">
<script src="/assets/js/runtime~main.682f6591.js" defer="defer"></script>
<script src="/assets/js/main.08eca37e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_OH5z" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"></a><a class="navbar__item navbar__link" href="/">Move Book</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/reference">Move Reference</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_aspp"><div class="navbar__search searchBarContainer_reza" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_Kpxf" value=""><div class="loadingRing_LRD_ searchBarLoadingRing_lY7z"><div></div><div></div><div></div><div></div></div></div></div><a href="https://github.com/MystenLabs/move-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><i class="fab fa-github"></i></a><div class="toggle_MW0i colorModeToggle_RHuM"><button class="clean-btn toggleButton_yw5v toggleButtonDisabled_BJd7" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><i aria-hidden="true" class="toggleIcon_oIOL lightToggleIcon_SFTY fas fa-moon"></i><i aria-hidden="true" class="toggleIcon_oIOL darkToggleIcon_ekgs fas fa-sun"></i><i aria-hidden="true" class="toggleIcon_oIOL systemToggleIcon_yi_a fas fa-moon"></i></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_wWoK"><div class="docsWrapper_nrtX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_xs6u" type="button"></button><div class="docRoot_XRUv"><aside class="theme-doc-sidebar-container docSidebarContainer_vhZZ"><div class="sidebarViewport_HXJ_"><div class="sidebar_B2tA"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_RelJ"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/reference/">The Move Reference</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Getting Started</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/modules">1. Modules</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Basic Concepts</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/primitive-types">2. Primitive Types</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/integers">2.1 Integers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/bool">2.2 Bool</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/address">2.3 Address</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/vector">2.4 Vector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/references">2.5 References</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/primitive-types/tuples">2.6 Tuples and Unit</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/variables">3. Local Variables and Scopes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/equality">4. Equality</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reference/abort-and-assert">5. Abort and Assert</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/abort-and-assert/clever-errors">5.1 Clever Errors</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/control-flow">6. Control Flow</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/conditionals">6.1 Conditional Expressions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/loops">6.2 Loops</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/labeled-control-flow">6.3 Labeled Control Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/control-flow/pattern-matching">6.4 Pattern Matching</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/reference/functions">7. Functions</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/functions/macros">7.1 Macros</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/structs">8. Structs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/enums">9. Enums</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/constants">10. Constants</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/generics">11. Generics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/abilities">12. Abilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/uses">13. Uses and Aliases</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Advanced Concepts</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/method-syntax">14. Method Syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/index-syntax">15. Index Syntax</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Tooling</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/packages">16. Packages</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/unit-testing">17. Unit Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/modes">18. Compilation Modes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/extensions">19. Module Extensions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Reference</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/coding-conventions">20. Coding Conventions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Deprecated</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/friends">21. Friends</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_oT2n"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_LCKf"><div class="docItemContainer_Jixr"><article><div class="tocCollapsible_vYTS theme-doc-toc-mobile tocMobile_QhsY"><button type="button" class="clean-btn tocCollapsibleButton_nB9w">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Abort and Assert</h1></header>
<p><a href="/reference/functions"><span class="inline-code">return</span></a> and <span class="inline-code">abort</span> are two control flow constructs that end execution, one for the
current function and one for the entire transaction.</p>
<p>More information on <a href="/reference/functions#return-expression"><span class="inline-code">return</span> can be found in the linked section</a></p>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="abort"><span class="inline-code">abort</span><a href="#abort" class="hash-link" aria-label="Direct link to abort" title="Direct link to abort">​</a></h2>
<p><span class="inline-code">abort</span> is an expression that takes either takes no arguments, or just one - an <strong>abort code</strong> of
type <span class="inline-code">u64</span>. For example:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">42</span><br></span></code></pre></div></div>
<p>The <span class="inline-code">abort</span> expression halts execution the current function and reverts all changes made to state by
the current transaction (note though that this guarantee must be upheld by the adapter of the
specific deployment of Move). There is no mechanism for &quot;catching&quot; or otherwise handling an <span class="inline-code">abort</span>.</p>
<p>Luckily, in Move transactions are all or nothing, meaning any changes to storage are made all at
once only if the transaction succeeds. For Sui, this means no objects are modified.</p>
<p>Because of this transactional commitment of changes, after an abort there is no need to worry about
backing out changes. While this approach is lacking in flexibility, it is incredibly simple and
predictable.</p>
<p>Similar to <a href="/reference/functions"><span class="inline-code">return</span></a>, <span class="inline-code">abort</span> is useful for exiting control flow when some condition
cannot be met.</p>
<p>In this example, the function will pop two items off of the vector, but will abort early if the
vector does not have two items</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">pop_twice</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;): (</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">, </span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">length</span><span class="token plain">() &lt; </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain">) </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">42</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    (v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">pop_back</span><span class="token plain">(), v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">pop_back</span><span class="token plain">())</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>This is even more useful deep inside a control-flow construct. For example, this function checks
that all numbers in the vector are less than the specified <span class="inline-code">bound</span>. And aborts otherwise</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">check_vec</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: &amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">bound</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> i = </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> n = v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">length</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> (i &lt; n) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> cur = v[i];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (cur &gt; bound) </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">42</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        i = i + </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p>Combine <span class="inline-code">macro</span> with <span class="inline-code">abort</span>:</p>
</blockquote>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">check_vec</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: &amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">bound</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    v.</span><span class="token macro-call macro-name support" style="color:#0184BC">do_ref</span><span class="token macro-call">!</span><span class="token plain">(|num| </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (*num &gt; bound) </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">42</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="assert"><span class="inline-code">assert</span><a href="#assert" class="hash-link" aria-label="Direct link to assert" title="Direct link to assert">​</a></h3>
<p><span class="inline-code">assert</span> is a builtin, macro operation provided by the Move compiler. It takes two arguments, a
condition of type <span class="inline-code">bool</span> and a code of type <span class="inline-code">u64</span></p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">condition</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">bool</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">code</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">)</span><br></span></code></pre></div></div>
<p>Since the operation is a macro, it must be invoked with the <span class="inline-code">!</span>. This is to convey that the
arguments to <span class="inline-code">assert</span> are call-by-expression. In other words, <span class="inline-code">assert</span> is not a normal function and
does not exist at the bytecode level. It is replaced inside the compiler with</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (condition) () </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> code</span><br></span></code></pre></div></div>
<p><span class="inline-code">assert</span> is more commonly used than just <span class="inline-code">abort</span> by itself. The <span class="inline-code">abort</span> examples above can be
rewritten using <span class="inline-code">assert</span></p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">pop_twice</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;): (</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">, </span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">length</span><span class="token plain">() &gt;= </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">2</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">42</span><span class="token plain">); </span><span class="token comment" style="color:#A0A1A7">// Now uses &#x27;assert&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    (v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">pop_back</span><span class="token plain">(), v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">pop_back</span><span class="token plain">())</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>and</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">check_vec</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: &amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">bound</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> i = </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> n = v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">length</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">while</span><span class="token plain"> (i &lt; n) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> cur = v[i];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">cur</span><span class="token plain"> &lt;= bound, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">42</span><span class="token plain">); </span><span class="token comment" style="color:#A0A1A7">// Now uses &#x27;assert&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        i = i + </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p>Combine <span class="inline-code">macro</span> with <span class="inline-code">assert</span>:</p>
</blockquote>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">check_vec</span><span class="token plain">(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: &amp;</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">bound</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    v.</span><span class="token macro-call macro-name support" style="color:#0184BC">do_ref</span><span class="token macro-call">!</span><span class="token plain">(|num| </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(*</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">num</span><span class="token plain"> &lt;= bound, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">42</span><span class="token plain">));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Note that because the operation is replaced with this <span class="inline-code">if-else</span>, the argument for the <span class="inline-code">code</span> is not
always evaluated. For example:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(</span><span class="token literals boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token plain">, </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> / </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">)</span><br></span></code></pre></div></div>
<p>Will not result in an arithmetic error, it is equivalent to</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (</span><span class="token literals boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token plain">) () </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> (</span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain"> / </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">)</span><br></span></code></pre></div></div>
<p>So the arithmetic expression is never evaluated!</p>
<h3 class="anchor anchorWithStickyNavbar_kl3l" id="abort-codes-in-the-move-vm">Abort codes in the Move VM<a href="#abort-codes-in-the-move-vm" class="hash-link" aria-label="Direct link to Abort codes in the Move VM" title="Direct link to Abort codes in the Move VM">​</a></h3>
<p>When using <span class="inline-code">abort</span>, it is important to understand how the <span class="inline-code">u64</span> code will be used by the VM.</p>
<p>Normally, after successful execution, the Move VM, and the adapter for the specific deployment,
determine the changes made to storage.</p>
<p>If an <span class="inline-code">abort</span> is reached, the VM will instead indicate an error. Included in that error will be two
pieces of information:</p>
<ul>
<li>The module that produced the abort (package/address value and module name)</li>
<li>The abort code.</li>
</ul>
<p>For example</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">0x2</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">example</span><span class="token module-header"> {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">aborts</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">42</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">0x3</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">invoker</span><span class="token module-header"> {</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">always_aborts</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0x2</span><span class="token plain">::</span><span class="token property-value">example</span><span class="token plain">::</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">aborts</span><span class="token plain">()</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>If a transaction, such as the function <span class="inline-code">always_aborts</span> above, calls <span class="inline-code">0x2::example::aborts</span>, the VM
would produce an error that indicated the module <span class="inline-code">0x2::example</span> and the code <span class="inline-code">42</span>.</p>
<p>This can be useful for having multiple aborts being grouped together inside a module.</p>
<p>In this example, the module has two separate error codes used in multiple functions</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token module-header module-keyword keyword" style="color:hsl(301, 63%, 40%)">module</span><span class="token module-header"> </span><span class="token module-header package-name constant" style="color:hsl(35, 99%, 36%)">0</span><span class="token module-header double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token module-header module-name entity" style="color:#C18401">example</span><span class="token module-header">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token use-import-fun use-keyword keyword" style="color:hsl(301, 63%, 40%)">use</span><span class="token use-import-fun"> std</span><span class="token use-import-fun double-colon punctuation" style="color:hsl(119, 34%, 47%)">::</span><span class="token use-import-fun">vector;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token const const-keyword keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token const"> </span><span class="token const error-const-name error-const" style="color:#E45649">EEmptyVector</span><span class="token const">: </span><span class="token const const-type support" style="color:#0184BC">u64</span><span class="token const"> = </span><span class="token const const-name constant" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token const const-keyword keyword" style="color:hsl(301, 63%, 40%)">const</span><span class="token const"> </span><span class="token const error-const-name error-const" style="color:#E45649">EIndexOutOfBounds</span><span class="token const">: </span><span class="token const const-type support" style="color:#0184BC">u64</span><span class="token const"> = </span><span class="token const const-name constant" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:#A0A1A7">// move i to j, move j to k, move k to i</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">rotate_three</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">k</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> n = v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">length</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(n &gt; </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token error-const" style="color:#E45649">EEmptyVector</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(i &lt; n, </span><span class="token error-const" style="color:#E45649">EIndexOutOfBounds</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(j &lt; n, </span><span class="token error-const" style="color:#E45649">EIndexOutOfBounds</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(k &lt; n, </span><span class="token error-const" style="color:#E45649">EIndexOutOfBounds</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">swap</span><span class="token plain">(i, k);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">swap</span><span class="token plain">(j, k);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token visibility keyword" style="color:hsl(301, 63%, 40%)">public</span><span class="token plain"> </span><span class="token function-keyword keyword" style="color:hsl(301, 63%, 40%)">fun</span><span class="token plain"> </span><span class="token function-name function" style="color:hsl(221, 87%, 60%)">remove_twice</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;(</span><span class="token property-name function-argument struct-property-name">v</span><span class="token plain">: &amp;</span><span class="token mut-keyword keyword" style="color:hsl(301, 63%, 40%)">mut</span><span class="token plain"> </span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">vector</span><span class="token plain">&lt;</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">&gt;, </span><span class="token property-name function-argument struct-property-name">i</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">, </span><span class="token property-name function-argument struct-property-name">j</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">u64</span><span class="token plain">): (</span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">, </span><span class="token struct-types entity" style="color:#C18401">T</span><span class="token plain">) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> n = v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">length</span><span class="token plain">();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(n &gt; </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">, </span><span class="token error-const" style="color:#E45649">EEmptyVector</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(i &lt; n, </span><span class="token error-const" style="color:#E45649">EIndexOutOfBounds</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(j &lt; n, </span><span class="token error-const" style="color:#E45649">EIndexOutOfBounds</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token macro-call macro-name support" style="color:#0184BC">assert</span><span class="token macro-call">!</span><span class="token plain">(i &gt; j, </span><span class="token error-const" style="color:#E45649">EIndexOutOfBounds</span><span class="token plain">);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    (v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">remove</span><span class="token plain">(i), v.</span><span class="token function-call function" style="color:hsl(221, 87%, 60%)">remove</span><span class="token plain">(j))</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_kl3l" id="the-type-of-abort">The type of <span class="inline-code">abort</span><a href="#the-type-of-abort" class="hash-link" aria-label="Direct link to the-type-of-abort" title="Direct link to the-type-of-abort">​</a></h2>
<p>The <span class="inline-code">abort i</span> expression can have any type! This is because both constructs break from the normal
control flow, so they never need to evaluate to the value of that type.</p>
<p>The following are not useful, but they will type check</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> </span><span class="token let-statement">y</span><span class="token plain">: </span><span class="token built-in-types support" style="color:#0184BC">address</span><span class="token plain"> = </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">;</span><br></span></code></pre></div></div>
<p>This behavior can be helpful in situations where you have a branching instruction that produces a
value on some branches, but not all. For example:</p>
<div class="language-move codeBlockContainer_AE_o theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_YOHW"><pre tabindex="0" class="prism-code language-move codeBlock_q9R9 thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_bu_M"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token let-keyword keyword" style="color:hsl(301, 63%, 40%)">let</span><span class="token plain"> b =</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (x == </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">0</span><span class="token plain">) </span><span class="token literals boolean" style="color:hsl(35, 99%, 36%)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">if</span><span class="token plain"> (x == </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">1</span><span class="token plain">) </span><span class="token literals boolean" style="color:hsl(35, 99%, 36%)">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">else</span><span class="token plain"> </span><span class="token control-flow keyword" style="color:hsl(301, 63%, 40%)">abort</span><span class="token plain"> </span><span class="token literals number" style="color:hsl(35, 99%, 36%)">42</span><span class="token plain">;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain"></span><span class="token comment" style="color:#A0A1A7">//       ^^^^^^^^ `abort 42` has type `bool`</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/reference/equality"><div class="pagination-nav__label"><i class="fa fa-angle-left"></i><span class="pagination-nav__label">4. Equality</span> </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/reference/abort-and-assert/clever-errors"><div class="pagination-nav__label"><span class="pagination-nav__label">5.1 Clever Errors</span> <i class="fa fa-angle-right"></i></div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_VdoB thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#abort" class="table-of-contents__link toc-highlight"><code>abort</code></a><ul><li><a href="#assert" class="table-of-contents__link toc-highlight"><code>assert</code></a></li><li><a href="#abort-codes-in-the-move-vm" class="table-of-contents__link toc-highlight">Abort codes in the Move VM</a></li></ul></li><li><a href="#the-type-of-abort" class="table-of-contents__link toc-highlight">The type of <code>abort</code></a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>